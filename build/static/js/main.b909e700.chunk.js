(this["webpackJsonpnc-news-app"]=this["webpackJsonpnc-news-app"]||[]).push([[0],{10:function(e,t,a){},25:function(e,t,a){e.exports=a(54)},30:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(22),c=a.n(o),l=(a(30),a(2)),i=a(3),s=a(5),m=a(4),u=a(6),p=a(1),d=(a(10),function(){return r.a.createElement(p.a,{id:"title",to:"/"},"NC NEWS SITE")}),h=a(8),b=a.n(h),_=function(e,t,a){return a?b.a.get("http://callum-goodley-nc-news-app.herokuapp.com/api/articles/".concat(a)).then((function(e){return e.data.article})):b.a.get("http://callum-goodley-nc-news-app.herokuapp.com/api/articles",{params:{topic:e,sort_by:t}}).then((function(e){return e.data.articles}))},E=function(e){return b.a.get("http://callum-goodley-nc-news-app.herokuapp.com/api/articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))},v=function(e,t,a){return b.a.post("http://callum-goodley-nc-news-app.herokuapp.com/api/articles/".concat(e,"/comments"),{body:t,username:a}).then((function(e){return e.data.comment}))},f=function(e){return b.a.delete("http://callum-goodley-nc-news-app.herokuapp.com/api/comments/".concat(e)).then((function(){return"comment deleted"}))},g=function(e,t,a){return e?b.a.patch("http://callum-goodley-nc-news-app.herokuapp.com/api/comments/".concat(e),{inc_votes:a}).then((function(e){return e.data.comment})):b.a.patch("http://callum-goodley-nc-news-app.herokuapp.com/api/articles/".concat(t),{inc_votes:a}).then((function(e){return e.data.comment}))},y=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={voteChange:0,err:null},a.handleClick=function(e){var t=Number(e.target.name),n=e.target.value;g(null,n,t),a.setState((function(e){return{voteChange:e.voteChange+t}}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("main",{id:"vote_button"},r.a.createElement("button",{key:"vote up button",name:1,id:"vote_button",value:this.props.article_id,onClick:this.handleClick,disabled:1===this.state.voteChange},"vote \u2191"),r.a.createElement("p",null,"votes: ",this.props.votes+this.state.voteChange),r.a.createElement("button",{key:"vote down button",name:-1,id:"vote_button",value:this.props.article_id,onClick:this.handleClick,disabled:-1===this.state.voteChange},"vote \u2193"))}}]),t}(r.a.Component),C=function(e){return e.article_id?[e.articles_list].map((function(t){var a=new Date(t.created_at);return r.a.createElement("ul",{key:t.article_id},r.a.createElement("li",{id:"article_card"},r.a.createElement("h2",null,t.title),r.a.createElement("br",null),r.a.createElement("p",null,"Author: ",t.author),r.a.createElement("br",null),r.a.createElement("p",null,"Posted: ",a.toString()),r.a.createElement("br",null),r.a.createElement("p",null,t.body),r.a.createElement(y,{votes:e.votes,article_id:e.article_id})))})):e.articles_list.map((function(e){var t=new Date(e.created_at);return r.a.createElement(p.a,{id:"article_card_home",to:"/".concat(e.article_id)},r.a.createElement("label",{key:e.article_id},r.a.createElement("li",{id:"home_article_card"},r.a.createElement("span",{id:"article_heading"},e.title),r.a.createElement("br",null),r.a.createElement("br",null),"Posted:",t.toString()," Comments: ",e.comment_count," Votes:",e.votes),r.a.createElement("br",null)))}))},k=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={articles_list:[],isLoading:!0,err:null},a.fetchArticles=function(){var e=a.props,t=e.topic,n=e.sort_by,r=e.article_id;_(t,n,r).then((function(e){a.setState({articles_list:e,isLoading:!1})})).catch((function(e){return a.setState({err:e.response,isLoading:!1})}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return!0===this.state.isLoading?r.a.createElement("p",null,"Loading...."):this.state.err?r.a.createElement("p",{id:"error"},this.state.err.status,": Article not found."):r.a.createElement(C,{votes:this.state.articles_list.votes,article_id:this.props.article_id,articles_list:this.state.articles_list,user:this.props.user})}},{key:"componentDidUpdate",value:function(e){this.props.sort_by!==e.sort_by&&this.fetchArticles(),this.props.topic!==e.topic&&this.fetchArticles()}},{key:"componentDidMount",value:function(){this.fetchArticles()}}]),t}(r.a.Component),j=function(){return r.a.createElement("nav",{id:"sort_by"},r.a.createElement(p.a,{id:"sort_by",to:"/sort/created_at"},"Latest"),r.a.createElement("br",null),r.a.createElement(p.a,{id:"sort_by",to:"/sort/votes"},"Top voted"),r.a.createElement("br",null),r.a.createElement(p.a,{id:"sort_by",to:"/sort/comment_count"},"Most comments"))},O=function(e){return r.a.createElement("main",{id:"article_page"},r.a.createElement("h2",{id:"all_heading"},"Todays top articles:"),r.a.createElement(j,{topic:e.topic,sort_by:e.sort_by}),r.a.createElement("ul",null,r.a.createElement(k,{user:e.user})),r.a.createElement("br",null))},w=function(e){var t=e.topic;return r.a.createElement("nav",{id:"sort_by"},r.a.createElement(p.a,{id:"sort_by",to:"/".concat(t,"/sort/created_at")},"Latest"),r.a.createElement("br",null),r.a.createElement(p.a,{id:"sort_by",to:"/".concat(t,"/sort/votes")},"Top voted"),r.a.createElement("br",null),r.a.createElement(p.a,{id:"sort_by",to:"/".concat(t,"/sort/comment_count")},"Most comments"))},S=function(e){return r.a.createElement("main",{id:"article_page"},r.a.createElement("h2",{id:"all_heading"},"Todays top ",e.topic," articles:"),r.a.createElement(w,{topic:e.topic,sort_by:e.sort_by}),r.a.createElement("ul",null,r.a.createElement(k,{topic:e.topic,user:e.user})),r.a.createElement("br",null))},A=function(){return r.a.createElement("nav",{id:"topic_link"},r.a.createElement(p.a,{id:"topic_link",to:"/"},"All"),r.a.createElement(p.a,{id:"topic_link",to:"topic/football"},"Football"),r.a.createElement(p.a,{id:"topic_link",to:"topic/cooking"},"Cooking"),r.a.createElement(p.a,{id:"topic_link",to:"topic/coding"},"Coding"))},D=function(e){var t=e.sort_by;return"comment_count"===e.sort_by&&(t="most commented"),"created_at"===e.sort_by&&(t="latest"),"votes"===e.sort_by&&(t="top voted"),r.a.createElement("main",{id:"article_page"},r.a.createElement("h2",{id:"all_heading"},"Todays top articles listed by ",t,":"),r.a.createElement(j,{topic:e.topic,sort_by:e.sort_by}),r.a.createElement("ul",null,r.a.createElement(k,{sort_by:e.sort_by,user:e.user})),r.a.createElement("br",null))},L=function(e){var t=e.sort_by;return"comment_count"===e.sort_by&&(t="most commented"),"created_at"===e.sort_by&&(t="latest"),"votes"===e.sort_by&&(t="top voted"),r.a.createElement("main",{id:"article_page"},r.a.createElement("h2",{id:"all_heading"},"Todays top ",e.topic," articles sorted by ",t,":"),r.a.createElement(w,{topic:e.topic,sort_by:e.sort_by}),r.a.createElement("ul",null,r.a.createElement(k,{topic:e.topic,sort_by:e.sort_by,user:e.user})),r.a.createElement("br",null))},U=a(11),N=a(24),V=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={inputValue:""},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(N.a)({},r,n))},a.handleSubmit=function(e){e.preventDefault(),a.props.addComment(a.state),a.setState({inputValue:""})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{id:"comment_box",onSubmit:this.handleSubmit},r.a.createElement("label",null,r.a.createElement("textarea",{rows:"6",cols:"95",type:"text",name:"inputValue",value:this.state.inputValue,placeholder:"Add a comment...",onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("button",{disabled:"guest"===this.props.user},"Submit comment.")))}}]),t}(r.a.Component),T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={voteChange:0,err:null},a.handleClick=function(e){var t=Number(e.target.name),n=e.target.value;g(n,null,t),a.setState((function(e){return{voteChange:e.voteChange+t}}))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("main",{id:"vote_button"},r.a.createElement("button",{key:"vote up button",name:1,value:this.props.comment_id,onClick:this.handleClick,disabled:1===this.state.voteChange},"vote \u2191"),r.a.createElement("p",null,"votes: ",this.props.votes+this.state.voteChange),r.a.createElement("button",{key:"vote down button",name:-1,value:this.props.comment_id,onClick:this.handleClick,disabled:-1===this.state.voteChange},"vote \u2193"))}}]),t}(r.a.Component),x=function(e){return r.a.createElement("button",{type:"submit",key:"delete button",value:e.comment_id,onClick:e.removeComment},"Delete comment.")},M=function(e){return e.comments_list.map((function(t){var a=new Date(t.created_at);return r.a.createElement("ul",{id:"card",key:"".concat(t.comment_id," card")},r.a.createElement("li",{key:t.comment_id},"User: ",t.author,r.a.createElement("br",null),r.a.createElement("br",null),"Comment: ",t.body,r.a.createElement("br",null),r.a.createElement("br",null),"Votes: ",t.votes," Posted: ",a.toString(),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(T,{votes:t.votes,comment_id:t.comment_id,voteDown:e.voteDown})),e.user===t.author?r.a.createElement(x,{key:"delete comment: ".concat(t.comment_id),removeComment:e.removeComment,comment_id:t.comment_id}):null)}))},P=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={comments_list:[],isLoading:!0,userName:"tickle122",err:null},a.fetchComments=function(){var e=a.props.article_id;E(e).then((function(e){a.setState({comments_list:e,isLoading:!1})})).catch((function(e){a.setState({err:e.response,isLoading:!1})}))},a.addComment=function(e){var t=e.inputValue;v(a.props.article_id,t,a.props.user).then((function(e){a.setState((function(t){return{comments_list:[].concat(Object(U.a)(t.comments_list),[e])}}))})).catch((function(e){a.setState({err:e.response,isLoading:!1})}))},a.removeComment=function(e){var t=e.target.value;f(t).then((function(e){a.setState((function(t){return{comments_list:[].concat(Object(U.a)(t.comments_list),[e])}}))}))},a.voteUp=function(e){var t=e.target.name,a=e.target.value;g(t,a)},a.voteDown=function(e){var t=e.target.name,a=e.target.value;g(t,a)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return!0===this.state.isLoading?r.a.createElement("p",null,"Loading...."):this.state.err?r.a.createElement("p",{id:"error"},this.state.err.status,": No comment found."):r.a.createElement("main",{id:"comment_section",key:"main"},r.a.createElement(V,{user:this.props.user,key:"comment box",article_id:this.props.article_id,userName:this.state.userName,addComment:this.addComment}),r.a.createElement(M,{key:"comment card",user:this.props.user,comments_list:this.state.comments_list,addComment:this.addComment,removeComment:this.removeComment,voteUp:this.voteUp,voteDown:this.voteDown,userName:this.state.userName}),r.a.createElement("br",null),r.a.createElement("br",null))}},{key:"componentDidUpdate",value:function(e,t){"comment deleted"===this.state.comments_list[this.state.comments_list.length-1]&&this.fetchComments(),this.state.comments_list.length!==t.comments_list.length&&this.fetchComments(),this.props.article_id!==e.article_id&&this.fetchComments()}},{key:"componentDidMount",value:function(){this.fetchComments()}}]),t}(r.a.Component),W=function(e){return r.a.createElement("main",{id:"comment_section"},r.a.createElement("h3",null,"Comments..."),r.a.createElement(P,{user:e.user,article_id:e.article_id}))},B=function(e){return r.a.createElement("main",{id:"article_page"},r.a.createElement(k,{article_id:e.article_id,user:e.user}),r.a.createElement(W,{article_id:e.article_id,user:e.user}))},I=function(e){return r.a.createElement("section",{id:"logged_in"},r.a.createElement("p",null,"user: ",e.user),"guest"===e.user?r.a.createElement(p.a,{to:"/login",id:"logged_in"},"Login"):r.a.createElement(p.a,{to:"/login",id:"logged_in"},"Change user"))},J=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={inputValue:"guest"},a.handleSubmit=function(e){var t=a.state.inputValue;e.preventDefault(),a.props.setUser(t)},a.handleChange=function(e){var t=e.target.value;a.setState({inputValue:t})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("form",{id:"login",onSubmit:this.handleSubmit},r.a.createElement("select",{onChange:this.handleChange},r.a.createElement("option",null,"guest"),r.a.createElement("option",null,"tickle122"),r.a.createElement("option",null,"grumpy19"),r.a.createElement("option",null,"happyamy2016"),r.a.createElement("option",null,"cooljmessy"),r.a.createElement("option",null,"weegembump"),r.a.createElement("option",null,"jessjelly")),r.a.createElement("button",{type:"submit"},"login")))}}]),t}(r.a.Component),F=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={user:"guest"},a.setUser=function(e){a.setState({user:e})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("main",{className:"App"},r.a.createElement(I,{setUser:this.setUser,user:this.state.user}),r.a.createElement(d,null),r.a.createElement(A,null),r.a.createElement("br",null),r.a.createElement(p.b,{primary:!1},r.a.createElement(J,{setUser:this.setUser,user:this.state.user,path:"/login"}),r.a.createElement(O,{path:"/",user:this.state.user}),r.a.createElement(S,{path:"topic/:topic",user:this.state.user}),r.a.createElement(D,{path:"/sort/:sort_by",user:this.state.user}),r.a.createElement(L,{path:"/:topic/sort/:sort_by",user:this.state.user}),r.a.createElement(B,{path:"/:article_id",user:this.state.user})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[25,1,2]]]);
//# sourceMappingURL=main.b909e700.chunk.js.map